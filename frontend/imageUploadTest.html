<!DOCTYPE html>
<html lang="de">

	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta name="theme-color" content="#3B7D23" />

		<title>File Upload Test Page</title>

		<!-- JQuerry fÃ¼r AJAX usw. -->
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

		<!-- Bootstrap CSS and icons -->
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
			
		<!-- Custom CSS -->
		<!-- Must be after Bootstrap CSS -->
		<link rel="stylesheet" href="./style.css">

		<!-- Common JS -->
		<script src="./js/common.js"></script>

		<script>

			async function onUploadFormSubmit(event, form)
			{
				// disable default event
				event.preventDefault();

				// disable Button
				let button = $("#uploadButton");
				button.prop('disabled', true);
				let value = button.prop("value");
				button.prop("value", 'Uploading...');


				// convert data of form to object
				var formData = new FormData(form);

				// upload
				let success = await uploadImageForPlant(formData);
				if(success)
				{
					displayAlert("Upload was successful yay", "success");
				}

				// enable Button
				button.prop('disabled', false);
				button.prop("value", value);
			}

			function init() {
				// Required
				initializeAlertDisplay();
				// Register event handler
				$('#uploadForm').submit(function(event) {
					onUploadFormSubmit(event, this);
				});
			}

			$(document).ready(function() {
				init();
			});
		</script>
	</head>

	<body style="background-color: black;">
		<main class="container-lg">
			<h1 class="text-white">Image Upload Test Page</h1>

			<form id="uploadForm" enctype="multipart/form-data" method="post">
				<input class="form-control" type="file" id="picture" name="picture" accept="image/*">
				<input type="hidden" id="plant_id" name="plant_id" value="1"/> <!--Musst be set to the correct id!-->
				<input class="btn btn-primary" type="submit" id="uploadButton" value="Upload this shit!">
			</form>

		</main>

		<!-- Bootstrap compiled and minified JavaScript -->
		<!-- Must be the last line inside the body!!! -->
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
	</body>
</html>